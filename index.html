<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –∏ –º–∞—Å—à—Ç–∞–±–∞ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- –ú–µ—Ç–∞-—Ç–µ–≥–∏ SEO –¥–ª—è –æ–±–æ–∏—Ö —è–∑—ã–∫–æ–≤ -->
    <meta name="description" content="TODO List is a handy notebook for managing tasks. Share your list offline and with others, access it anytime, and improve your productivity.">
    <meta name="keywords" content="TODO, task list, notebook, productivity, tasks, management, save, self, localhost-four, task management, productivity, task list, to-do list, organizational tool, efficient tasks, manage tasks">
    <meta name="author" content="/">

    <!-- Open Graph –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π (Facebook, LinkedIn, WhatsApp) -->
    <meta property="og:title" content="TODO List - Task Management App">
    <meta property="og:description" content="Manage your tasks effectively. Share your TODO list offline and with others. Access your tasks anytime, anywhere.">
    <meta property="og:image" content="1img.gif">
    <meta property="og:url" content="/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="TODO List">
    
    <!-- –ú–µ—Ç–∞-—Ç–µ–≥–∏ –¥–ª—è Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TODO List - Task Management App">
    <meta name="twitter:description" content="Manage your tasks effectively. Share your TODO list offline and with others. Access your tasks anytime, anywhere.">
    <meta name="twitter:image" content="1img.gif">
    <meta name="twitter:url" content="/">
    
    <!-- Robot Follow -->
    <meta name="robots" content="index, follow">
    <meta name="language" content="en">
    <meta name="rating" content="General">
    <meta name="theme-color" content="#ffffff">

    <!-- Schema.org Structured Data for Better SEO -->
    <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "WebSite",
            "url": "/",
            "name": "TODO List",
            "description": "A comprehensive app for task management. Keep your tasks organized and accessible.",
            "author": {
                "@type": "Organization",
                "name": "TODO"
            },
            "potentialAction": {
                "@type": "SearchAction",
                "target": "/?state={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
    </script>
    
    <!-- –ó–∞—â–∏—Ç–∞ –æ—Ç XSS —Å –ø–æ–º–æ—â—å—é Content Security Policy (CSP) -->
    <meta http-equiv="Content-Security-Policy" content="
        font-src 'self'; 
        object-src 'none'; 
        frame-ancestors 'none'; 
        base-uri 'self'; 
        form-action 'self';
    ">
    <!-- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–ª–∏–∫–¥–∂–µ–∫–∏–Ω–≥–∞ -->
    <meta http-equiv="X-Frame-Options" content="DENY">
    <!-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ X-Content-Type-Options -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Strict-Transport-Security (HSTS) —á–µ—Ä–µ–∑ –º–µ—Ç–∞-—Ç–µ–≥ -->
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains">
    <!-- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (CORS) -->
    <meta http-equiv="Access-Control-Allow-Origin" content="self">
    <!-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Permissions-Policy –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ -->
    <meta http-equiv="Permissions-Policy" content="web-share=(), midi=(), gyroscope=(), fullscreen=(), document-domain=(), notifications=(self), popups=(self)">

    <meta name="referrer" content="no-referrer">
    <meta name="HandheldFriendly" content="True">

    <!-- –ò–∫–æ–Ω–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
    <link rel="icon" href="1img.gif">
    <link rel="apple-touch-icon" href="1img.gif">
    <link rel="icon" sizes="192x192" href="1img.gif">
    <link rel="icon" sizes="512x512" href="1img.gif">

    <!-- –ú–∞–Ω–∏—Ñ–µ—Å—Ç –¥–ª—è PWA -->
    <link rel="manifest" href="manifest.json">
    <link href="%PUBLIC_URL%/manifest.json" rel="manifest" />

    <!-- Yandex.RTB -->
    <script async defer src="https://mc.yandex.ru/metrika/tag.js"></script>
    <script>window.yaContextCb=window.yaContextCb||[]</script>
    <link rel="preconnect" href="https://yastatic.net">
    <link rel="preconnect" href="https://avatars.mds.yandex.net">
    <link rel="preconnect" href="https://mc.yandex.ru">
    <link rel="preconnect" href="https://ads.adfox.ru">
    
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html"
            height="0" width="0" style="display:none;visibility:hidden" id="tag-manager">
        </iframe>
    </noscript>

    <script async crossorigin="anonymous" src="https://yastatic.net/safeframe-bundles/0.83/host.js"></script>
    <script async crossorigin="anonymous" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.1/gsap.min.js"></script>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <title>TODO List ‚Äî Task Management App</title>

    <!-- Firebase SDK -->
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Firebase SDK –¥–ª—è –º–æ–¥—É–ª–µ–π -->
    <script type="module" src="join.js" defer></script>

    <link rel="stylesheet" href="styles.css" loading="lazy">
    <script src="script.js" defer nonce="xyz123" loading="lazy"></script>
    <script src="manifest.js" defer nonce="xyz123" loading="lazy"></script>
    <script src="service-worker.js" defer nonce="xyz123" loading="lazy"></script>
    <script src="ban.js" defer nonce="xyz123" loading="lazy"></script>
    <script src="mods.js" defer nonce="xyz123" loading="lazy"></script> <!-- mods scroll -->
    <script src="coockie.js" defer nonce="xyz123" loading="lazy"></script> 
</head>
<body allowfullscreen="allowfullscreen" jstcache="0" contenteditable="false" >
    <div class="app-container">
        <header class="noselect">
            
            <div class="app-header">
                <a href="#top" onclick="copy()" nonce="xyz123">üì•</a>
                <a href="home/">üì§</a>
                <div class="tabs-container">
                    <button class="tab" nonce="xyz123" onclick="openNewBoardTab()">DESK</button>
                    <button class="tab" nonce="xyz123" onclick="openAddTaskModal()">TASK</button>
                    <button class="tab" id="theme-button" onclick="themes()" ondblclick="custom()">/set</button>
                </div>
            </div>
        </header>

        <div class="tabs-container">
            <div id="tabs" class="noselect"></div>
        </div>

        <div class="task-container" id="task-container">
            <!-- –î–æ—Å–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>
        
        <!-- Modal for Adding Tasks -->
        <div class="modal" id="addTaskModal">
            <div class="draggable" id="draggable1" onmousedown="startDrag(event, this)"><br>
                <div class="modal-content">
                    <span class="close" onclick="closeModal()" nonce="xyz123">&times;</span>
                    <h2>Add Task</h2>
                    <input type="text" id="taskTitle" placeholder="Task Title">
                    <input type="date" id="taskDeadline">
                    <script nonce="xyz123">
                        document.getElementById('taskDeadline').value = new Date().toISOString().split('T')[0];
                    </script>
                    <textarea id="taskDescription" placeholder="Task Description"></textarea>
                    <input type="url" id="taskImageUrl" placeholder="Image URL (Only for Image)">
                    <input type="url" id="taskLink" placeholder="Resource Link (url)">
                    <select id="taskPriority">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                    <button onclick="addTask()" nonce="xyz123">Add Task</button>
                    <div id="filePreview" class="file-preview"></div>
                </div>
            </div>
        </div>

        <!-- Modal for Board Settings -->
        <div class="modal" id="settingsModal">
            <div class="draggable" id="draggable1" onmousedown="startDrag(event, this)"><br>
                <div class="modal-content">
                    <span class="close" onclick="closeSettings()" nonce="xyz123">&times;</span>
                    <h2>Board Settings</h2>
                    <label>Emoji:</label>
                    <input type="text" id="emojiInput">
                    <label>Background Color:</label>
                    <input type="color" id="backgroundColorInput">
                    <label>Text Color:</label>
                    <input type="color" id="textColorInput">
                    <label>Style:</label>
                    <select id="styleInput" value="flex">
                        <option value="block">Block</option>
                        <option value="grid">Grid</option>
                        <option value="flex">Flex</option>
                        <option value="ruby">Ruby</option>
                        <option value="inline">Inline</option>
                        <option value="contents">Contents</option>
                        <option value="flow-root">Flow-root</option>
                    </select>
                    <label>Text-Align:</label>
                    <select id="textAlignSelector" value="left">
                        <option value="left">Left</option>
                        <option value="center">Center</option>
                        <option value="right">Right</option>
                        <option value="justify">Justify</option>
                        <option value="end">End</option>
                        <option value="start">Start</option>
                        <option value="unset">Unset</option>
                        <option value="initial">Initial</option>
                    </select>
                    <button onclick="applyBoardSettings()" nonce="xyz123">Apply</button>
                    
                </div>
            </div>
        </div>

        <!-- Modal for adding comment -->
        <div id="commentModal" class="modal">
            <div class="draggable" id="draggable1" onmousedown="startDrag(event, this)"><br>
                <div class="modal-content">
                    <h2>Add Comment</h2>
                    <textarea id="commentText" placeholder="Enter your comment..."></textarea>
                    
                    <div>
                        <label for="urlInput">Image URL:</label>
                        <input type="url" id="urlInput" placeholder="Enter image URL">
                    </div>
                    
                    <button id="saveCommentBtn">Save Comment</button>
                    <button onclick="closeCommentModal()" nonce="xyz123">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
        const dragItems = document.querySelectorAll('.draggable');
        let draggedElement = null;

        dragItems.forEach(item => {
            item.addEventListener('dragstart', function (e) {
                draggedElement = e.target;
                draggedElement.style.transform = 'scale(1.1)';
                draggedElement.style.zIndex = 1000;
            });

            item.addEventListener('dragend', function () {
                draggedElement.style.transform = 'scale(1)';
                draggedElement.style.zIndex = 10;
            });

            item.addEventListener('dragover', function (e) {
                e.preventDefault();
                const dropArea = e.target.closest('.drag-drop-area');
                if (dropArea) {
                    dropArea.style.borderColor = '#2980b9';
                }
            });

            item.addEventListener('dragleave', function (e) {
                e.target.closest('.drag-drop-area').style.borderColor = '#3498db';
            });

            item.addEventListener('drop', function (e) {
                e.preventDefault();
                const dropArea = e.target.closest('.drag-drop-area');
                if (dropArea && draggedElement) {
                    dropArea.appendChild(draggedElement);
                    draggedElement.style.transform = 'scale(1)';
                }
                dropArea.style.borderColor = '#3498db';
            });
        });

        let isDragging = false;
        let offsetX, offsetY;
    
        function startDrag(e, element) {
            isDragging = true;
            element.classList.add('dragging');
    
            // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞
            offsetX = e.clientX - element.getBoundingClientRect().left;
            offsetY = e.clientY - element.getBoundingClientRect().top;
    
            document.addEventListener('mousemove', (event) => drag(event, element));
            document.addEventListener('mouseup', stopDrag);
        }
    
        function drag(e, element) {
            if (!isDragging) return;
    
            const parent = element.parentElement;
    
            // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            const newX = e.clientX - offsetX;
            const newY = e.clientY - offsetY;
    
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            const parentRect = parent.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
    
            if (newX < parentRect.left) {
                element.style.left = '0px';
            } else if (newX + elementRect.width > parentRect.right) {
                element.style.left = `${parentRect.width - elementRect.width}px`;
            } else {
                element.style.left = `${newX - parentRect.left}px`;
            }
    
            if (newY < parentRect.top) {
                element.style.top = '0px';
            } else if (newY + elementRect.height > parentRect.bottom) {
                element.style.top = `${parentRect.height - elementRect.height}px`;
            } else {
                element.style.top = `${newY - parentRect.top}px`;
            }
        }
    
        function stopDrag() {
            isDragging = false;
            const element = document.querySelector('.draggable.dragging');
            element.classList.remove('dragging');
    
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }
    
    </script>
    

</body>
</html>
